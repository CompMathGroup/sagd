\documentclass[12pt,a4paper]{article}
%\usepackage[cp1251]{inputenc}
\setlength{\voffset}{-1in}
\setlength{\topmargin}{20mm}
\setlength{\headheight}{0mm}
\setlength{\headsep}{0mm}
\setlength{\hoffset}{-1in}
\setlength{\oddsidemargin}{25mm}
\setlength{\marginparwidth}{0mm}
\setlength{\marginparsep}{0mm}
\setlength{\textheight}{247mm}
\setlength{\textwidth}{165mm}
\usepackage{indentfirst}
\usepackage{setspace}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage{amsmath,amssymb}
\usepackage[english, russian]{babel}
\usepackage[hidelinks]{hyperref}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}

\linespread{1.5}
%\captionsetup{width=\textwidth}

%\title{Численное моделирование парогравитационной технологии добычи высоковязких нефтей}
%\author{Фирсов Егор}
\begin{document}
%\maketitle
{
	
\thispagestyle{empty}
\begin{center}
Министерство образования и науки Российской Федерации
\\
Федеральное государственное автономное образовательное учреждение\\[-6pt] высшего профессионального образования\\[-6pt]
«Московский физико-технический институт\\[-6pt]
(государственный университет)»
\\
Факультет аэрофизики и~космических исследований\\[-6pt]
Кафедра вычислительной математики\\
\end{center}

\vspace{20mm}

\begin{center}
{\large {\bf Численное моделирование парогравитационной технологии добычи высоковязких нефтей\\[8mm] }} 
Выпускная квалификационная работа \\
(бакалаврская работа)\\
Направление подготовки: 03.03.01 Прикладные математика и физика
\end{center}

\vspace{20mm}

\begin{flushleft}
\begin{tabularx}{\textwidth}{lcl}
Выполнил: \\
Студент 131 группы  & \rule{5cm}{1pt} & Фирсов Егор Игоревич \\[5mm]

Научный руководитель:\\
к.ф.-м.н., доцент & \rule{5cm}{1pt} & Скалько Юрий Иванович \\[5mm]
Научный консультант:\\
д.ф.-м.н.              & \rule{5cm}{1pt} & Колдоба Александр Васильевич \\
\end{tabularx}
\end{flushleft}

\vfill

\begin{center}
 Москва 2015
\end{center}
}

\newpage
\tableofcontents
\newpage
\section{Введение}


Значительная доля нефтяных запасов России приходится на высоковязкие нефти и битумы. Поэтому проблема добычи высоковязких нефтей и битумов крайне актуальна. Их добыча сложна из-за большой вязкости ($\mu > 30000 $ сПуаз). 

Существуют технологии помогающие при добыче такой нефти. Одна из них это подвод тепла к области, в том числе с помощью технологии парогравитационного дренажа. Эта технология состоит из двух этапов. Первый этап — подогрев области с помощью циркулирующего внутри труб пара. Второй - закачка горячего пара в пласт.

\begin{figure}[h!]
\begin{center}
\includegraphics[width=14cm]{./other/SAGD_2.jpg}
\caption{Схема парогравитационного дренажа}
\end{center}
\end{figure}

\subsection {Постановка задачи}

В данной работе рассмотрен первый этап парогравитационного дренажа, то есть подогрев области. В отличии от традиционной задачи фильтрации здесь считается, что скелет не является монолитной структурой, а подвижен. Рассматривается одномерная полубесконечная область, расположенная вертикально. Она заполнена двумя подвижными фазами песком и нефтью. Нефть при пластовой температуре имеет большую вязкость и практически не фильтруется. Нижняя граница области имеет большую температуру. Благодаря конвекции и теплопроводности область начинает прогреваться, вязкость нефти уменьшается, и песок приобретает подвижность и начинает двигаться относительно нефти под действием силы тяжести.

Во втором разделе предложена одномерная модель процесса  и получены уравнения, необходимые для решения поставленной задачи. Далее задача разбита на несколько подзадач: изотермической фильтрации, теплопроводности, изотермической фильтрации с предельной насыщенностью, и наконец решена задача неизотермической фильтрации с предельной насыщенностью. При решении каждой подзадачи были построены вычислительные алгоритмы и разработаны программные комплексы, реализующие их. Также для подзадач изотермической фильтрации и теплопроводности были построены аналитические решения.



%\newpage
\subsection{Обозначения}
Индекс a  = l, s обозначает жидкую и твердую фазу.
\begin{itemize}
\item $\theta_a $ --- Объемная доля a-ой фазы
\item $\rho_a$ --- Плотность а-ой фазы ($[\rho_a] = \text{Кг/м}^3$)
\item $e_a$ --- Плотность энергии a-ой фазы ($[e_a] = \text{Дж/м}^3$)
\item $T $ --- Температура ($[T] =\text{К}$)
\item $\lambda$ --- Коэффициент теплопроводности среды ($[\lambda] = \text{Дж/(м с К)}$)
\item $c_a$ --- Плотность теплоемкости а-ой фазы ($[c_a] = \text{Дж/К}$)
\item $V_a$ --- Скорость а-ой фазы ($[V_a] = \text{м/с} $)
\item $W$ --- Скорость фильтрации ($[W] = \text{м/с} $)
\item $h_a$ --- плотность энтальпии ($[h_a] = \text{Дж/м}^3$)
\item $\psi$ - отношение объемных долей двух фаз($\psi = \frac{\theta_l}{\theta_s} $)
\end{itemize}


\newpage
\section{Математическая модель}
\subsection{Уравнения модели}
Выпишем уравнения необходимые для решения задачи. Это уравнение непрерывности, уравнение сохранения энергии и определяющее соотношение в виде закона Дарси. Введем следующие обозначения: $z$ --- вертикальная координата, $t$ --- время. В уравнениях присутствуют 2 индекса --- $ l $ и $ s$, означающие, что данная величина относится к жидкой фазе (нефти) или твердой фазе (песку) соответственно. $\theta$ --- объемная доля соответствующей фазы, $ V $ --- скорость.

Уравнения непрерывности жидкой и твердой фаз, при условии что источников вещества нет, выглядят следующим образом:
\begin{equation}
\pd{\rho_l\theta_l}{t} + \pd{V_l\theta_l\rho_l}{z} =0
\label{eq:contin_l}
\end{equation}
\begin{equation}
\pd{\rho_s\theta_s}{t} + \pd{V_s\theta_s\rho_l}{z} =0
\label{eq:contin_s}
\end{equation}

Сумма объемных долей жидкой и твердой фазы равна единице.
\begin{equation}
\theta_l + \theta_s = 1
\label{eq:satur}
\end{equation}

Считаем, что источники энергии отсутствуют. В этом случае уравнение сохранения энергии принимает следующий вид:
\begin{equation}
\begin{aligned}
&\pd{E}{t} + \pd{Q}{z} =0 \\
&E=\theta_l e_l + \theta_s e_s \\
&Q=\theta_l h_l V_l + \theta_s h_s V_s - \lambda \pd{T}{z}\\
\label{eq:conserv}
\end{aligned}
\end{equation}

%\begin{equation}
%\pd{\theta_l\rho_l e_l + \theta_s\rho_s e_s }{t} + \pd{ \theta_l\rho_l h_l + \theta_s\rho_s h_s - \lambda \pd{T}{z} }{z} = 0
%\end{equation}
Считаем, что твердая фаза несжимаема

\begin{equation}
\begin{aligned}
%\rho_l = const \\ 
\rho_s = const \\
\label{rho_const}
\end{aligned}
\end{equation}

Тогда уравнение \eqref{eq:contin_s}, принимает вид
\begin{equation}
\pd{\theta_s}{t} + \pd{\theta_s V_s}{z} = 0
\label{fluid}
\end{equation}

Учитывая \eqref{fluid} перейдем к Лагранжевой координате $dx$ связанной с твердой фазой
\begin{equation}
dx = \theta_s dz - \theta_s V_s dt
\label{dx_dz}
\end{equation}

Чтобы переписать наши уравнения в лагранжевых координатах посмотрим как связаны дифференцирование по $ z $ и по $ x $
\begin{equation}
\begin{aligned}
&\left(\pd{f}{t}\right)_z = \pd{(f , z)}{(t , z)}\\
&\partial(f , z) = \frac{1}{\theta_s}\partial(f , x) + V_s \partial(f , t)\\
&\pd{(f , z)}{(t , z)} = \frac{1}{\theta_s}\pd{(f , x)}{(t , z)} + V_s\pd{(f , t)}{(t , z)}\\
\end{aligned}
\label{help1}
\end{equation}

Для $ f = t $ 
$$
\partial(t , z) = \frac{1}{\theta_s} \partial(t , x) + V_s \partial(t , t) = \frac{1}{\theta_s} \partial(t , x)
$$

Из \eqref{help1}, используя предыдущее равенство получаем
$$
\left(\pd{f}{t}\right)_z = \pd{(f , x)}{(t , x)} + V_s \theta_s\pd{(f ,t)}{(t , x)}
$$

Далее получаем
\begin{equation}
\begin{aligned}
&\left(\pd{f}{t}\right)_z = \left(\pd{f}{t}\right)_x - V_s\theta_s\left(\pd{f}{x}\right)_t\\
&\left(\pd{f}{z}\right)_t = \theta_s\left(\pd{f}{x}\right)_t\\
\end{aligned}
\label{z_x}
\end{equation}

Применим полученные равенства к уравнению непрерывности для твердой фазы \eqref{fluid}. Переходим к новой переменной.
$$
\pd{\theta_s}{t} - V_s\theta_s\pd{\theta_s}{x} + \theta_s\pd{V_s\theta_s}{x} =0
$$

Расписывая третий член, и сокращая подобные члены, получаем
$$
\pd{V_s}{x} + \frac{1}{\theta_s^2}\pd{\theta_s}{t} = 0
$$

Отсюда
\begin{equation}
\pd{V_s}{x} = \pd{}{t}\frac{1}{\theta_s}
\label{V_s}
\end{equation}

\subsection{Уравнение непрерывности в лагранжевых координатах}
Теперь, используя полученные равенства, перепишем уравнение непрерывности для жидкой фазы в новых переменных. Преобразуем \eqref{eq:contin_l}добавив и вычтя член $V_s\pd{\rho_l\theta_l}{z} $
$$
\pd{\rho_l\theta_l}{t} + V_s\pd{\rho_l\theta_l}{z} - V_s\pd{\rho_l\theta_l}{z} + \pd{V_l\theta_l\rho_l}{z} =0
$$

Сгруппировав члены и используя \eqref{z_x}, получаем:
$$
\left(\pd{\rho_l\theta_l}{t}\right)_x - V_s\theta_s \left(\pd{\rho_l\theta_l}{x}\right)_t + \theta_s\left(\pd{\rho_l\theta_l(V_l - V_s)}{x}\right)_t + \rho_l\theta_l\theta_s\left(\pd{V_s}{x}\right)_t + V_s\theta_s \left(\pd{\rho_l\theta_l}{x}\right)_t = 0
$$

Перепишем последнее уравнение, используя \eqref{V_s} и поделив на $\theta_s$
$$
\frac{1}{\theta_s}\pd{\rho_l\theta_l}{t} + \pd{\rho_l\theta_l(V_l-V_s)}{x} + \rho_l\theta_l\pd{}{t}\frac{1}{\theta_s} = 0
$$

Сгруппировав первый и последний члены, выпишем
\begin{equation}
\pd{}{t}\frac{\rho_l\theta_l}{\theta_s} + \pd{}{x}\rho_l\theta_l(V_l - V_s) = 0
\label{filtr_compr_1}
\end{equation}

Обозначим отношение объемных долей жидкой и твердой фазы за $\psi $: 
$$
\psi = \frac{\theta_l}{\theta_s} 
$$

Все величины $\theta_l $, $\theta_s $, $\psi $ - выражаются друг через друга, поэтому возможно использование любой из них. Для удобства будем использовать $\psi$.

Введем скорость фильтрации $W$ как
\begin{equation}
W = \theta_l (V_l - V_s )
\label{W_filtr}
\end{equation}

Тогда в предположении, что жидкая фаза не сжимаема, получаем уравнение непрерывности в лагранжевых координатах
\begin{equation}
\pd{\psi}{t} + \pd{}{x}W = 0
\label{filtr_compr}
\end{equation}

\subsection{Уравнение сохранения энергии в лагранжевых координатах}
Перепишем уравнение сохранения энергии в лагранжевых переменных. Используем \eqref{eq:conserv} и \eqref{z_x}
$$
\pd{E}{t} - V_s\theta_s\pd{E}{x} + \theta_s\pd{Q}{x} = 0
$$

Отсюда
$$
\frac{1}{\theta_s}\pd{E}{t} + \pd{}{x}(Q-V_s E) + E\pd{V_s}{x} = 0
$$

Используем \eqref{V_s}, группируя члены, получаем
\begin{equation}
\pd{}{t}\frac{E}{\theta_s} + \pd{}{x}(Q - V_s E) = 0
\end{equation}

$$
Q-V_s E = \theta_l e_l V_l + \theta_s e_s V_s + \theta_l P + \theta_s P -V_s(\theta_l e_l +\theta_s e_s) - \lambda\theta_s\pd{T}{x}
$$

Сокращаем подобные члены, учитываем \eqref{filtr_compr}, получаем уравнение сохранения энергии в новых переменных
\begin{equation}
\pd{(e_s + \psi e_l)}{t} + \pd{}{x}(e_l W - \lambda\theta_s\pd{T}{x}) = 0
\label{eq:conserv_new}
\end{equation}

Это уравнение наряду с \eqref{filtr_compr} являются основными для решения поставленной задачи. Кроме них нужно определяющее соотношение для замыкания системы.

\subsection{Закон Дарси}
Выпишем закон Дарси для жидкой фазы \cite{Kond_mech_2007}.
\begin{equation}
W= -\frac{K k(\theta)}{\eta}\left(\pd{p}{z} - \rho_l g \right)
\label{Darsi}
\end{equation}

Здесь $ K $ --- абсолютная проницаемость (так как она константа, далее она будет опускаться и просто входить в проницаемость k), $k(\theta)$ --- проницаемость, функция от объемных долей жидкой и твердой фаз, $p$ --- давление. 

Предположим, что процесс развивается квазистатически, т. е. сила тяжести действующая на смесь фаз, компенсирует давление:
\begin{equation}
\pd{p}{z} = (\rho_l \theta_l + \rho_s \theta_s)g
\label{ravn}
\end{equation}

Из \eqref{ravn} и \eqref{Darsi} получаем:
\begin{equation}
W= -\theta_s \frac{k(\theta)}{\eta}(\rho_l-\rho_s)g
\label{Darsi_new}
\end{equation}

Для расчета проницаемости используется комбинация формул. В пределе малой объемной доли твердой фазы, когда взаимодействием между частицами можно пренебречь, используется следствие формулы Стокса:
$$
k = 2 K\frac{\psi^2}{(1+\psi)^2} 
$$

В пределе большой объемной доли твердой фазы, когда учитывается взаимодействие между частицами используется формула Кармана-Козени:
$$
k = K\frac{\psi^3}{(1+\psi)^2}
$$

Здесь и далее $\theta_s $ внесена в проницаемость $k$. %и формулы переписаны в переменной $\psi$ . 

Комбинируем эти формулы (берем среднее гармоническое). Получаем:

\begin{equation}
k = K \frac{4\psi^3}{(1+\psi)^2(2+\psi)}
\label{permability}
\end{equation}

\begin{figure}[h!]
\begin{center}
\includegraphics[width=80mm]{./other/Perm_diff.eps}
\caption{График функции проницаемости}
\end{center}
\end{figure}
%--------------------------------------------------------------------------------------------------------------
\newpage
\section{Изотермическая фильтрация}
\subsection{Математическая модель}
Для решения задачи изотермической фильтрации достаточно уравнения непрерывности, закона Дарси и выражения для проницаемости. Выпишем их:
\begin{equation}
\begin{aligned}
&\pd{\psi}{t} + \pd{}{x}W = 0\\
&W= \frac{k(\psi)}{\eta}(\rho_s-\rho_l)g\\
&k = K \frac{4\psi^3}{(1+\psi)^2(2+\psi)}\\
\label{isotermal}
\end{aligned}
\end{equation}

\subsection{Численный метод}
Запишем разностную схему
\begin{itemize}
\item Вычисляем проницаемость:
\begin{equation}
k_m = k(\psi_m) , \ m = 0,  \dots ,M
\label{perm_razn}
\end{equation}

\item Вычисляем скорости фильтрации на границах всех ячеек. Используем противопоточную аппроксимацию. То есть сносим нужные значения из ячейки расположенной против потока. Считается, что скорость фильтрации направлена всегда вверх, поэтому на границе $i + \frac12$ сносим проницаемость из ячейки $i$.
\begin{equation}
W_{m+\frac12} = \frac{k(\psi_m)}{\eta}(\rho_s-\rho_l)g \ , \ m = 0,  \dots ,M-1
\label{Darsi_razn}
\end{equation}

\item Переходим на новый слой по времени, вычисляем отношение насыщенностей в каждой ячейке
\begin{equation}
\psi_m^{n+1} = \psi_m^n - \tau\frac{W_{m+1/2} - W_{m-1/2}}{h} \ , \ m = 1,  \dots ,M
\label{filtr_razn}
\end{equation}
\end{itemize}

\subsection{Аналитическое решение}
Подставим выражение для скорости фильтрации и проницаемости в \eqref{isotermal}, переходим к квазилинейной форме уравнения:
\begin{equation}
\pd{\psi}{t} - a K \pd{k}{\psi} \pd{\psi}{x} = 0,\  \text{Где}\ a = \frac{8(\rho_l-\rho_s)g}{\eta}
\label{characteristics}
\end{equation}

Гиперболическое уравнение \eqref{characteristics} решается методом характеристик:
$$
\xi = \frac{x}{t} = a K \pd{k}{\psi} =   a K \frac{2\psi^3 + 3\psi^2}{(1 + \psi)^3(2+\psi)^2}
$$

Начальное условие $\psi_0 = 5$ и граничное $\psi_1 = 0$ моделируют область со смесью песка и нефти с непроницаемой границей снизу. Характеристики уравнения \eqref{characteristics} показаны на рисунке \ref{charact}
\begin{figure}[ht!]
\begin{center}
\includegraphics[width=12cm]{./other/charact_corr.eps}
\caption{Семейство характеристик}
\label{charact}
\end{center}
\end{figure}

\subsection{Результаты численных расчетов}
На рисунке \ref{vol_fraction} показана зависимость объемной доли флюида от лагранжевой координаты. Синим пунктиром изображено аналитическое решение. Красной сплошной линией --- численное решение. На рисунке видно три различных области: слева центрированная волна, где уплотняется песок, затем скачок и стационарная область. Из графика видно, что решение разностной задачи хорошо аппроксимирует аналитическое решение, немного размывается рядом со скачком, что является последствием использования схемы первого порядка.
\begin{figure}[h!]
\begin{center}
\includegraphics[width=16cm]{./other/new_Filtration_3.jpg}
\caption{Распределение объемной доли флюида}
\label{vol_fraction}
\end{center}
\end{figure}
%--------------------------------------------------------------------------------------------------------------
\newpage
\section{Изотермическая фильтрация с предельной насыщенностью}
\subsection{Математическая модель}
Объемная доля твердой фазы не может достигнуть единицы. В любом случае останется пространство между частицами, заполненное флюидом \cite{Dobr_phys02}. Из этого следует, что существуют два случая: первый, если объемная доля твердой фазы меньше предельной. В этом случае верно следствие закона Дарси, приведенное в задаче изотермической фильтрации. Второй случай реализуется, если объемная доля твердой фазы достигает предельной. Тогда уравнения принимают вид стандартной однофазной фильтрации.

\begin{equation}
\begin{cases}
\theta_s < \theta_s^*,\  W = \frac{k(\psi)}{\eta} (\rho_s - \rho_l) g\\
\theta_s = \theta_s^*,\  \pd{W}{x} = 0\\
\end{cases}
\end{equation}

Уравнение непрерывности и выражение для проницаемости остаются теми же, что и для задачи изотермической фильтрации\eqref{isotermal}.

\subsection{Численный метод}
Вычисляем проницаемость:
\begin{equation}
k_m = k(\psi_m) , \ m = 0,  \dots ,M
\label{perm_razn2}
\end{equation}

Вычисляем скорость фильтрации на границе текущей ячейки. Как и ранее используется противопоточная аппроксимация.
\begin{equation}
W_{m+1/2} = \frac{k(\psi_m)}{\eta}(\rho_s-\rho_l)g
\label{Darsi_razn2}
\end{equation}

Вычисляем отношение насыщенностей в текущей ячейке. 
\begin{equation}
\psi_m^{n+1} = \psi_m^n - \tau\frac{W_{m+1/2} - W_{m-1/2}}{h}
\label{filtr_razn2}
\end{equation}
Существование предельной объемной доли твердой фазы, больше которой эта доля не может вырасти, означает существование предельного отношения объемных долей, меньше которого это отношение не может опуститься.

Если $\psi$ больше предельного, переходим на следующую ячейку.

Если же наоборот отношение объемных долей опустилось ниже предельного, приравниваем его предельному и пересчитываем скорость фильтрации, используя уравнение непрерывности \eqref{filtr_razn2} с известным отношением объемных долей равным предельному.

\begin{equation}
\begin{aligned} 
&\psi_{m}^{n+1} = \psi^* \\
&W_{m+1/2} = \frac{(\psi_m^n - \psi^*)h}{\tau} + W_{m-1/2} \\
\end{aligned}
\label{corr_razn}
\end{equation}

\subsection{Результаты численных расчетов}
На рисунке \ref{crit_perm_picture} видно четыре различных области. Первая --- область, где объемная доля песка достигла предельной. Далее центрированная волна, затем скачок и выход на стационарную область, которую еще не достигло возмущение. 
\begin{figure}[h!]
\begin{center}
\includegraphics[width=150mm]{./other/crit_satur.png}
\caption{Распределение объемной доли флюида}
\label{crit_perm_picture}
\end{center}
\end{figure}
%--------------------------------------------------------------------------------------------------------------------------
\newpage
\section{Теплопроводность}
\subsection{Математическая модель}
Решим следующую задачу. 
Пусть объемная доля твердой фазы во всей рассматриваемой области достигла предельного значения. На нижней границе задана скорость фильтрации равная нулю. Тогда скорость фильтрации во всей области равна нулю. Температура границы больше температуры области. Уравнение сохранения энергии \eqref{eq:conserv_new} принимает вид:
$$
(c_l \psi + c_s)\pd{T}{t} =-\theta_s \pd{q}{x}
$$
$$
q = -\lambda\pd{T}{x}
$$

\subsection{Численный метод}
Для решения используется явная схема.
\begin{equation}
\begin{aligned}
&q_{m+1/2} = - \lambda\frac{T_{m+1} - T_m}{h}\\
&T_m^{n+1} = - \tau \theta_s\frac{q_{m+1/2} - q_{m-1/2}}{h(c_l \psi + c_s)} + T_m^n\\
\label{termal_razn}
\end{aligned}
\end{equation}
\subsection{Аналитическое решение}
Перепишем уравнение сохранения энергии в виде уравнения теплопроводности и решим его аналитически:
\begin{equation}
\pd{T}{t} = \varkappa\pd{^2 T}{x^2},\ \text{где } \varkappa = \frac{\lambda \theta_s}{c_l \psi +  c_s}
\end{equation}

Его решение имеет вид:
\begin{equation}
T(x,t) = T_1-T_0 + T_0 \operatorname{erfc} \left(\frac{x}{\sqrt{4\varkappa t}}\right)	
\end{equation}
где erfc(x) - Дополнительная функция ошибок:
$$
erfc(x) = \int_{x}^{+\infty}e^{- \eta^2}d\eta
$$
\subsection{Результаты численных расчетов}
На рисунке \ref{Temp_pict} изображено распределение температуры. Зеленая сплошная линия --- численное решение, черный пунктир --- аналитическое. Из рисунка видно, что численное решение хорошо аппроксимирует аналитическое.
\begin{figure}[h!]
\begin{center}
\includegraphics[width=155mm]{./other/Temp_Analyt.png}
\caption{Распределение температуры}
\label{Temp_pict}
\end{center}
\end{figure}
%--------------------------------------------------------------------------------------------------------------------------
\newpage
\section{Неизотермическая фильтрация с предельной насыщенностью}
\subsection{Математическая модель}

Выпишем еще раз все уравнения.
$$
\pd{\psi}{t} + \pd{W}{x} = 0
$$

Ранее коэффициент вязкости $\eta$ был константой. Теперь же он зависит от температуры по модельному экспоненциальному закону.
\begin{equation}
\eta = \eta_0 e^{-\alpha(T - T_{0})}
\label{viscos}
\end{equation}

Этот закон --- частный случай закона Фогеля. Он хорошо аппроксимирует поведение вязкости нефти на небольшом промежутке температур.

Закон Дарси имеет такой же вид как и в прошлом разделе.
$$
\begin{cases}
\theta_s < \theta_s^*,\  W = \frac{k(\psi)}{\eta(T)} (\rho_s - \rho_l) g\\
\theta_s = \theta_s^*,\  \pd{W}{x} = 0\\
\end{cases}
$$

Для расчета температуры понадобится уравнение сохранения энергии \eqref{eq:conserv_new}:
$$
\pd{(e_l\psi+e_s)}{t} + \pd{}{x}(e_l W - \lambda\theta_s\pd{T}{x}) = 0
$$
где $ e_l =  c_l T,\ e_s =  c_s T $ .



\subsection{Численный метод}
Для вычисления потоков тепла между ячейками и температуры на границах, как и для скорости фильтрации используем противопоточную аппроксимацию.
\begin{enumerate}
\item Вычисляем вязкость:
$$
\eta_m = \eta_0 e^{-\alpha(T_m^n - T_{0})},\ m = 0, \dots ,M
$$
\item Вычисляем относительную проницаемость:
$$
k_m = k(\psi_m) , \ m = 0,  \dots ,M
$$
\item Вычисляем потоки тепла между ячейками:
$$
q_{m+\frac12} = - \lambda (\theta_{s})_m^{n} \frac{T_{m+1}^n - T_m^n}{h} 
$$

Теперь проходим не весь временной слой сразу, а идем по одной ячейке, что бы корректировать скорость фильтрации в случае достижения предельной объемной доли.
\item Вычисляем скорость фильтрации на текущей границе ячеек:
$$
W_{m+\frac12} = -\frac{k_{m+\frac12}}{(\eta)_{m+\frac12}}(\rho_s - \rho_l)g
$$
\item  Вычисляем отношение объемных долей:
$$
\psi_m^{n+1} = \psi_m^n - \tau \frac{W_{m+\frac12} - W_{m-\frac12}}{h}
$$
\item Если отношение объемных долей упало меньше предельной, приравниваем его предельному и корректируем скорость фильтрации:
$$
\begin{aligned}
&\psi_{i}^{n+1} = \psi^* \\
&W_{i+1/2} = \frac{(\psi_i^n - \psi^*)h}{\tau} + W_{i-1/2} \\
\end{aligned}
$$
\item Вычисляем температуру на новом слое. 
\begin{multline}
 T_m^{n+1} =  \left(\frac{1}{\psi_m^{n+1} c_l + c_s}\right)\left( (\psi_m^n  c_l + c_s)
- \tau\frac{q_{m+\frac12} - q_{m-\frac12}}{h} - \tau\frac{c_l T_{m+\frac12}^n W_{m+\frac12} - c_l T_{m-\frac12} W_{m-\frac12}}{h}\right)
\end{multline}
\end{enumerate}

Уравнение непрерывности является гиперболическим. Для устойчивости необходимо соблюдение условия Куранта. Рассчитаем шаг по времени необходимый для устойчивости схемы для уравнения непрерывности:
$$
\frac{\tau a_{max}}{h} < \frac12 ,\ \ a_{max} = \left|\pd{W}{\psi}\right|_{max}
$$
$$
\tau_1 = \frac{h}{2 a_{max}},\ \  a_{max} = 8 K (\rho_s - \rho_l)g\left|\frac{2\psi^3 + 3\psi^2}{\eta(1 + \psi)^3(2+\psi)^2}\right|_{max}
$$
%Конвективные члены в уравнении энергии не играют большой роли. Поэтому условие на устойчивость определяется из уравнения теплопроводности:
%$$
%\pd{t}{t} = \frac{\theta_s\lambda}{(c_l \psi + c_s) }\pd{^2 T}{x^2}
%$$

\subsection{Результаты численных расчетов}
На рисунке \ref{end_picture}  --- зависимость объемной доли жидкой фазы от эйлеровой корординаты, красным  ---- с подогревом, синим --- без него. Видно что в случае, когда область подогревается снизу, жидкая фаза продвинулась дальше. Из-за нагрева вязкость жидкой фазы уменьшается, она начинает фильтроваться быстрее, поэтому на температурном фронте появляется скачок объемной доли флюида, как результат того что перед температурным фронтом жидкая фаза фильтруется медленнее а за фронтом быстрее. 

\begin{figure}[ht!]
\begin{center}
\includegraphics[width=150mm]{./other/old_heat_noheat.png}
\caption{Распределение объемной доли флюида}
\label{end_picture}
\end{center}
\end{figure}

На следующем рисунке \ref{end_pict_2} зависимость температуры подогреваемой области в тот же момент времени от эйлеровой координаты. Он отличается от стандартного вида теплопроводности, из-за наличия конвективных членов в уравнении сохранения энергии.
\newpage
\begin{figure}[ht!]
\begin{center}
\includegraphics[width=150mm]{./other/old_Temperature.png}
\caption{Распределение температуры}
\label{end_pict_2}
\end{center}
\end{figure}

Вязкость зависит по модельному экспоненциальному закону от температуры. Меняется на несколько порядков при прогревании области.

\begin{figure}[ht!]
\begin{center}
\includegraphics[width=150mm]{./other/old_Viscosity.png}
\caption{Распределение вязкости}
\end{center}
\end{figure}
\newpage
\section{Заключение}
Основные результаты:
\begin{itemize}
\item Построена математическая модель задачи неизтермической фильтрации с предельной насыщенностью.
\item Разработан вычислительный алгоритм численного интегрирования уравнений этой задачи.
\item Построены аналитические решения задач теплопроводности и изотермической фильтрации для тестирования программной реализации.
\item Проведены расчеты.
\item Исследовано влияние подвода тепла на процесс фильтрации.
\item Планируется построить модель первого и второго этапов технологии парогравитационного дренажа в двумерной постановке.
\end{itemize}
\newpage
\bibliographystyle{utf8gost71u} 
\bibliography{literature} 

\end{document}